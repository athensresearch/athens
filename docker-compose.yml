version: "3"
services:
  athens-server:
    build: .
    restart: always
    expose:
      - 3010 # Change this according to config.edn
    volumes:
      - datahike-db:/srv/athens/db
    environment:   # set environment variables
      datahike_store_path: /srv/athens/db


  nginx:
    image: nginx
    depends_on:
      - athens-server
    restart: always
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    ports:
      - 80:80

volumes:
  datahike-db:
